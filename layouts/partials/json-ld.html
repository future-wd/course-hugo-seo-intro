{{- $scratch := newScratch -}}

{{- /* https://developers.google.com/search/docs/advanced/structured-data/breadcrumb#json-ld_1
  breadcrumb structured markup json-ld */ -}}
{{- $scratch.Set "itemCount" 1 -}}
{{- define "partials/inline/breadcrumbData" -}}
  {{- $scratchCtx := .scratch -}}
  {{- with .parent -}}
    {{- partial "inline/breadcrumbData" (dict "scratch" $scratchCtx "parent" .Parent) -}} 
    {{- $scratchCtx.Add "listItem" (slice (dict 
      "@type" "ListItem"
      "position" ($scratchCtx.Get "itemCount")
      "name" (.Title | humanize | title)
      "item" .Permalink
    )) -}}
    {{- $scratchCtx.Add "itemCount" 1 -}}
  {{- end -}}
{{- end -}}
{{- partial "inline/breadcrumbData" (dict "scratch" $scratch "parent" .Parent) -}}  
{{- $scratch.Add "listItem" (slice (dict 
    "@type" "ListItem"
    "position" ($scratch.Get "itemCount")
    "name" (.Title | humanize | title)
  )) -}}

{{- $scratch.SetInMap "breadcrumb" "@context" "https://schema.org" -}}
{{- $scratch.SetInMap "breadcrumb" "@type" "BreadcrumbList" -}}
{{- $scratch.SetInMap "breadcrumb" "itemListElement" ($scratch.Get "listItem") -}}

<script type="application/ld+json">
{{- $scratch.Get "breadcrumb" | jsonify (dict "prefix" " " "indent" "  ") | safeJS }}
</script>